<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Tic Tac Toe</title>
  <style>
    body { font-family: system-ui, Arial, sans-serif; display:flex; min-height:100vh; align-items:center; justify-content:center; background:#0b1220; color:#e6e9ef; }
    .wrap { width: 320px; }
    h1 { font-size: 20px; margin: 0 0 10px; }
    .status { margin: 0 0 12px; opacity: .9; }
    .board { display:grid; grid-template-columns: repeat(3, 1fr); gap:10px; }
    button.cell {
      height: 90px; font-size: 42px; font-weight: 700;
      border-radius: 12px; border: 1px solid rgba(255,255,255,.15);
      background: rgba(255,255,255,.06); color:#e6e9ef; cursor:pointer;
    }
    button.cell:hover { background: rgba(255,255,255,.10); }
    button.cell:disabled { cursor:not-allowed; opacity:.8; }
    .row { display:flex; gap:10px; margin-top: 12px; }
    .btn {
      flex:1; padding:10px 12px; border-radius: 10px; border: 1px solid rgba(255,255,255,.15);
      background: rgba(255,255,255,.08); color:#e6e9ef; cursor:pointer;
    }
    .btn:hover { background: rgba(255,255,255,.12); }
    .hint { font-size: 12px; opacity: .75; margin-top: 10px; }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Tic Tac Toe</h1>
    <div id="status" class="status">Player X’s turn</div>

    <div id="board" class="board" aria-label="Tic Tac Toe board"></div>

    <div class="row">
      <button id="reset" class="btn">Reset</button>
      <button id="toggle" class="btn">Mode: 2 Players</button>
    </div>

    <div class="hint">Tip: Switch to “vs Computer” to play against a simple AI.</div>
  </div>

  <script>
    const statusEl = document.getElementById("status");
    const boardEl = document.getElementById("board");
    const resetBtn = document.getElementById("reset");
    const toggleBtn = document.getElementById("toggle");

    let board, currentPlayer, gameOver, vsComputer;

    const WIN_LINES = [
      [0,1,2],[3,4,5],[6,7,8],
      [0,3,6],[1,4,7],[2,5,8],
      [0,4,8],[2,4,6]
    ];

    function init() {
      board = Array(9).fill(null);
      currentPlayer = "X";
      gameOver = false;
      vsComputer = false;
      toggleBtn.textContent = "Mode: 2 Players";
      render();
      setStatus();
    }

    function setStatus(extra = "") {
      if (gameOver) return;
      statusEl.textContent = `Player ${currentPlayer}’s turn${extra}`;
    }

    function winnerInfo(b) {
      for (const [a,c,d] of WIN_LINES) {
        if (b[a] && b[a] === b[c] && b[a] === b[d]) return { winner: b[a], line: [a,c,d] };
      }
      if (b.every(Boolean)) return { winner: "draw", line: null };
      return { winner: null, line: null };
    }

    function render() {
      boardEl.innerHTML = "";
      board.forEach((val, idx) => {
        const btn = document.createElement("button");
        btn.className = "cell";
        btn.type = "button";
        btn.textContent = val ?? "";
        btn.disabled = gameOver || Boolean(val) || (vsComputer && currentPlayer === "O");
        btn.addEventListener("click", () => handleMove(idx));
        boardEl.appendChild(btn);
      });
    }

    function handleMove(i) {
      if (gameOver || board[i]) return;

      board[i] = currentPlayer;

      const { winner } = winnerInfo(board);
      if (winner) return endGame(winner);

      currentPlayer = currentPlayer === "X" ? "O" : "X";
      render();
      setStatus();

      if (vsComputer && currentPlayer === "O" && !gameOver) {
        // small delay so it feels like a turn
        setStatus(" (Computer thinking...)");
        setTimeout(() => {
          computerMove();
        }, 250);
      }
    }

    function endGame(winner) {
      gameOver = true;
      render();
      if (winner === "draw") statusEl.textContent = "It’s a draw.";
      else statusEl.textContent = `Player ${winner} wins!`;
    }

    // Simple AI: win if possible, block if needed, else pick center/corners/any
    function computerMove() {
      if (gameOver) return;

      const move =
        findBestImmediateMove("O") ??
        findBestImmediateMove("X") ?? // block
        (board[4] ? null : 4) ??
        firstAvailable([0,2,6,8]) ??
        firstAvailable([1,3,5,7]);

      if (move !== null && move !== undefined) {
        board[move] = "O";
        const { winner } = winnerInfo(board);
        if (winner) return endGame(winner);
        currentPlayer = "X";
        render();
        setStatus();
      }
    }

    function findBestImmediateMove(player) {
      for (let i = 0; i < 9; i++) {
        if (board[i]) continue;
        const copy = board.slice();
        copy[i] = player;
        if (winnerInfo(copy).winner === player) return i;
      }
      return null;
    }

    function firstAvailable(indices) {
      for (const i of indices) if (!board[i]) return i;
      return null;
    }

    resetBtn.addEventListener("click", () => {
      const keepMode = vsComputer;
      init();
      vsComputer = keepMode;
      toggleBtn.textContent = vsComputer ? "Mode: vs Computer" : "Mode: 2 Players";
      render();
      setStatus();
      if (vsComputer && currentPlayer === "O") computerMove();
    });

    toggleBtn.addEventListener("click", () => {
      vsComputer = !vsComputer;
      toggleBtn.textContent = vsComputer ? "Mode: vs Computer" : "Mode: 2 Players";
      // If switching to vs computer and it's O's turn, let computer play
      render();
      setStatus();
      if (vsComputer && currentPlayer === "O" && !gameOver) computerMove();
    });

    init();
  </script>
</body>
</html>
